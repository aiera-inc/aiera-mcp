rules:
  - id: hardcoded-api-key
    patterns:
      - pattern: |
          $VAR = "..."
      - metavariable-regex:
          metavariable: $VAR
          regex: (?i)(api[_-]?key|secret|token|password)
    message: Possible hardcoded API key or secret
    languages: [python]
    severity: WARNING

  - id: potential-sql-injection
    patterns:
      - pattern: |
          $QUERY = f"SELECT * FROM ... WHERE {$USER_INPUT}"
      - pattern: |
          $QUERY = "SELECT * FROM ... WHERE " + $USER_INPUT
    message: Potential SQL injection vulnerability
    languages: [python]
    severity: ERROR

  - id: hardcoded-credentials
    patterns:
      - pattern-either:
          - pattern: |
              password = "..."
          - pattern: |
              secret = "..."
          - pattern: |
              token = "..."
    message: Hardcoded credentials detected
    languages: [python]
    severity: WARNING
